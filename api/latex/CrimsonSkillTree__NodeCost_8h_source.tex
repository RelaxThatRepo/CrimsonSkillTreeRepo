\doxysection{Crimson\+Skill\+Tree\+\_\+\+Node\+Cost.\+h}
\hypertarget{CrimsonSkillTree__NodeCost_8h_source}{}\label{CrimsonSkillTree__NodeCost_8h_source}\index{Source/CrimsonSkillTree/Nodes/Cost/CrimsonSkillTree\_NodeCost.h@{Source/CrimsonSkillTree/Nodes/Cost/CrimsonSkillTree\_NodeCost.h}}
\mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ Crimson\ Sword\ Studio,\ 2024.\ All\ Rights\ Reserved.}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}CoreMinimal.h"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}GameplayEffectTypes.h"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}Engine/DataTable.h"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}CrimsonSkillTree\_NodeCost.generated.h"{}}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#define\ LOCTEXT\_NAMESPACE\ "{}CrimsonSkillTree"{}}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00016\ UENUM(BlueprintType)}
\DoxyCodeLine{00017\ enum\ class\ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bd}{ENodeCostSource}}\ :\ uint8}
\DoxyCodeLine{00018\ \{}
\DoxyCodeLine{00019\ \ \ \ \ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bda78bf044ae090f0eb9bcb6dd017f54a7a}{NoCost}},}
\DoxyCodeLine{00020\ \ \ \ \ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bda547076ea3776dc2515bdd95bad3af0ff}{ActorIntegerProperty}},}
\DoxyCodeLine{00021\ \ \ \ \ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bda3e4f2f77c8bd735878370209b774dcb4}{GameplayAttributeValue}}}
\DoxyCodeLine{00022\ \};}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00029\ USTRUCT(BlueprintType)}
\DoxyCodeLine{00030\ struct\ \mbox{\hyperlink{structFNodeCostDefinition}{FNodeCostDefinition}}}
\DoxyCodeLine{00031\ \{}
\DoxyCodeLine{00032\ \ \ \ \ GENERATED\_BODY()}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \ \ UPROPERTY(EditAnywhere,\ BlueprintReadWrite,\ Category\ =\ \textcolor{stringliteral}{"{}Cost\ Definition"{}})}
\DoxyCodeLine{00035\ \ \ \ \ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bd}{ENodeCostSource}}\ CostSource\ =\ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bd}{ENodeCostSource}}::\mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bda78bf044ae090f0eb9bcb6dd017f54a7a}{NoCost}};}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{comment}{//\ User-\/facing\ name\ for\ this\ resource\ (e.g.,\ "{}Skill\ Points"{}).}}
\DoxyCodeLine{00038\ \ \ \ \ UPROPERTY(EditAnywhere,\ BlueprintReadWrite,\ Category\ =\ "{}Cost\ Definition"{})}
\DoxyCodeLine{00039\ \ \ \ \ FText\ ResourceUserFacingName;}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{comment}{//\ The\ name\ of\ an\ integer\ property\ on\ the\ owner\ actor\ to\ use\ as\ the\ resource\ pool.}}
\DoxyCodeLine{00042\ \ \ \ \ UPROPERTY(EditAnywhere,\ BlueprintReadWrite,\ Category\ =\ "{}Cost\ Definition"{},\ meta\ =\ (EditCondition\ =\ "{}CostSource\ ==\ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bd}{ENodeCostSource}}::\mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bda547076ea3776dc2515bdd95bad3af0ff}{ActorIntegerProperty}}"{}))}
\DoxyCodeLine{00043\ \ \ \ \ FName\ ActorResourcePropertyName;}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{comment}{//\ The\ gameplay\ attribute\ to\ use\ as\ the\ resource\ pool.}}
\DoxyCodeLine{00046\ \ \ \ \ UPROPERTY(EditAnywhere,\ BlueprintReadWrite,\ Category\ =\ "{}Cost\ Definition"{},\ meta\ =\ (EditCondition\ =\ "{}CostSource\ ==\ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bd}{ENodeCostSource}}::\mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bda3e4f2f77c8bd735878370209b774dcb4}{GameplayAttributeValue}}"{}))}
\DoxyCodeLine{00047\ \ \ \ \ FGameplayAttribute\ ResourceGameplayAttribute;}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{comment}{//\ Equality\ operator\ for\ TMap\ support.}}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keywordtype}{bool}\ operator==(const\ \mbox{\hyperlink{structFNodeCostDefinition}{FNodeCostDefinition}}\&\ Other)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00051\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (CostSource\ !=\ Other.CostSource)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (CostSource)}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bda547076ea3776dc2515bdd95bad3af0ff}{ENodeCostSource::ActorIntegerProperty}}:}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ActorResourcePropertyName\ ==\ Other.\mbox{\hyperlink{structFNodeCostDefinition_a94459d025cd799aa0b4d0c6df237b18f}{ActorResourcePropertyName}};}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bda3e4f2f77c8bd735878370209b774dcb4}{ENodeCostSource::GameplayAttributeValue}}:}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ResourceGameplayAttribute\ ==\ Other.ResourceGameplayAttribute;}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bda78bf044ae090f0eb9bcb6dd017f54a7a}{ENodeCostSource::NoCost}}:}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00063\ \ \ \ \ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{comment}{//\ Helper\ function\ to\ get\ a\ clean\ resource\ name,\ with\ fallbacks.}}
\DoxyCodeLine{00066\ \ \ \ \ FText\ \mbox{\hyperlink{structFNodeCostDefinition_a2a5d0e855def5dff72f01600d0289c30}{GetResourceName}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00067\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!ResourceUserFacingName.IsEmpty())}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ResourceUserFacingName;}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (CostSource\ ==\ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bda547076ea3776dc2515bdd95bad3af0ff}{ENodeCostSource::ActorIntegerProperty}}\ \&\&\ ActorResourcePropertyName\ !=\ NAME\_None)}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FText::FromName(ActorResourcePropertyName);}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (CostSource\ ==\ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bda3e4f2f77c8bd735878370209b774dcb4}{ENodeCostSource::GameplayAttributeValue}}\ \&\&\ ResourceGameplayAttribute.IsValid())}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FText::FromString(ResourceGameplayAttribute.GetName());}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ LOCTEXT(\textcolor{stringliteral}{"{}UnknownResourceName"{}},\ \textcolor{stringliteral}{"{}Resource"{}});}
\DoxyCodeLine{00081\ \ \ \ \ \}}
\DoxyCodeLine{00082\ \};}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \textcolor{comment}{//\ Hash\ function\ for\ TMap\ support.}}
\DoxyCodeLine{00085\ \textcolor{keyword}{inline}\ uint32\ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_ad01f88b8896feb2d2e026dcccf665b12}{GetTypeHash}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structFNodeCostDefinition}{FNodeCostDefinition}}\&\ Def)}
\DoxyCodeLine{00086\ \{}
\DoxyCodeLine{00087\ \ \ \ \ uint32\ Hash\ =\ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_ad01f88b8896feb2d2e026dcccf665b12}{GetTypeHash}}(\textcolor{keyword}{static\_cast<}uint8\textcolor{keyword}{>}(Def.\mbox{\hyperlink{structFNodeCostDefinition_a77a6ae0928c01603c7110d90c5e68169}{CostSource}}));}
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keywordflow}{if}\ (Def.\mbox{\hyperlink{structFNodeCostDefinition_a77a6ae0928c01603c7110d90c5e68169}{CostSource}}\ ==\ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bda547076ea3776dc2515bdd95bad3af0ff}{ENodeCostSource::ActorIntegerProperty}})}
\DoxyCodeLine{00089\ \ \ \ \ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ Hash\ =\ HashCombine(Hash,\ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_ad01f88b8896feb2d2e026dcccf665b12}{GetTypeHash}}(Def.\mbox{\hyperlink{structFNodeCostDefinition_a94459d025cd799aa0b4d0c6df237b18f}{ActorResourcePropertyName}}));}
\DoxyCodeLine{00091\ \ \ \ \ \}}
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (Def.\mbox{\hyperlink{structFNodeCostDefinition_a77a6ae0928c01603c7110d90c5e68169}{CostSource}}\ ==\ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_a74955e8c8617f5c679e0cf47c43f54bda3e4f2f77c8bd735878370209b774dcb4}{ENodeCostSource::GameplayAttributeValue}})}
\DoxyCodeLine{00093\ \ \ \ \ \{}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ Hash\ =\ HashCombine(Hash,\ \mbox{\hyperlink{CrimsonSkillTree__NodeCost_8h_ad01f88b8896feb2d2e026dcccf665b12}{GetTypeHash}}(Def.\mbox{\hyperlink{structFNodeCostDefinition_adb4d0e0dda5d1ba29d62b5f3b64edb0e}{ResourceGameplayAttribute}}));}
\DoxyCodeLine{00095\ \ \ \ \ \}}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordflow}{return}\ Hash;}
\DoxyCodeLine{00097\ \}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00103\ USTRUCT(BlueprintType)}
\DoxyCodeLine{00104\ struct\ \mbox{\hyperlink{structFNodeResourceCost}{FNodeResourceCost}}}
\DoxyCodeLine{00105\ \{}
\DoxyCodeLine{00106\ \ \ \ \ GENERATED\_BODY()}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{comment}{//\ The\ type\ of\ resource\ this\ cost\ uses.}}
\DoxyCodeLine{00109\ \ \ \ \ UPROPERTY(EditAnywhere,\ BlueprintReadWrite,\ Category\ =\ \textcolor{stringliteral}{"{}Cost"{}})}
\DoxyCodeLine{00110\ \ \ \ \ \mbox{\hyperlink{structFNodeCostDefinition}{FNodeCostDefinition}}\ CostDefinition;}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{comment}{//\ A\ curve\ to\ define\ how\ the\ cost\ scales\ with\ the\ node's\ level.}}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{comment}{//\ X-\/axis:\ Node\ Level,\ Y-\/axis:\ Cost\ Amount.}}
\DoxyCodeLine{00114\ \ \ \ \ UPROPERTY(EditAnywhere,\ BlueprintReadWrite,\ Category\ =\ "{}Cost"{})}
\DoxyCodeLine{00115\ \ \ \ \ TObjectPtr<UCurveFloat>\ CostCurve;}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{comment}{//\ A\ flat\ amount\ of\ cost,\ used\ if\ CostCurve\ is\ not\ provided.}}
\DoxyCodeLine{00118\ \ \ \ \ UPROPERTY(EditAnywhere,\ BlueprintReadWrite,\ Category\ =\ "{}Cost"{},\ meta\ =\ (EditCondition\ =\ "{}CostCurve\ ==\ \textcolor{keywordtype}{nullptr}"{}))}
\DoxyCodeLine{00119\ \ \ \ \ int32\ CostAmount\ =\ 1;}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00127\ \ \ \ \ int32\ GetCostForTargetLevel(int32\ TargetLevel,\ int32\ MaxLevel)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00128\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (CostCurve)}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FMath::RoundToInt(CostCurve-\/>GetFloatValue(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(TargetLevel)));}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ CostAmount;}
\DoxyCodeLine{00134\ \ \ \ \ \}}
\DoxyCodeLine{00135\ \};}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00141\ USTRUCT(BlueprintType)}
\DoxyCodeLine{00142\ struct\ \mbox{\hyperlink{structFResolvedNodeCost}{FResolvedNodeCost}}}
\DoxyCodeLine{00143\ \{}
\DoxyCodeLine{00144\ \ \ \ \ GENERATED\_BODY()}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \ \ UPROPERTY(BlueprintReadOnly,\ Category\ =\ \textcolor{stringliteral}{"{}Resolved\ Cost"{}})}
\DoxyCodeLine{00147\ \ \ \ \ \mbox{\hyperlink{structFNodeCostDefinition}{FNodeCostDefinition}}\ CostDefinition;}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \ \ \ \ UPROPERTY(BlueprintReadOnly,\ Category\ =\ "{}Resolved\ Cost"{})}
\DoxyCodeLine{00150\ \ \ \ \ int32\ ResolvedAmount\ =\ 0;}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \ \ \mbox{\hyperlink{structFResolvedNodeCost}{FResolvedNodeCost}}()\ =\ default;}
\DoxyCodeLine{00153\ \ \ \ \ \mbox{\hyperlink{structFResolvedNodeCost}{FResolvedNodeCost}}(const\ \mbox{\hyperlink{structFNodeCostDefinition}{FNodeCostDefinition}}\&\ InDef,\ int32\ InAmount)}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ :\ CostDefinition(InDef),\ ResolvedAmount(InAmount)\ \{\}}
\DoxyCodeLine{00155\ \};}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \textcolor{preprocessor}{\#undef\ LOCTEXT\_NAMESPACE}}

\end{DoxyCode}
